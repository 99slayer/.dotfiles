- defaults:
    link:
      create: true
      relink: true

- create:
  - ~/.local/bin/share

# bash
- link:
  ~/.bash_aliases: bash/.bash_aliases
  ~/.bashrc: bash/.bashrc
  ~/.bashrc.shared: bash/.bashrc.shared

# git
- shell:
  - '[ -x "$(command -v git)" ] || ( sudo apt-get update && apt-get install git )'

- link:
  ~/.gitconfig: git/.gitconfig

# nvm + node
- shell:
  - '[ -x "$(command -v npm)" ] || ( cd ~ && sudo apt install curl &&
    sudo apt update && sudo apt upgrade &&
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash &&
    export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")" [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" )'
  - '[ -x "$(command -v node)" ] || ( cd ~ && nvm install --lts && nvm use --lts )'

# pnpm
- shell:
  - '[ -x "$(command -v pnpm)" ] || npm install -g pnpm@latest-10'

# alacritty
- shell:
  - '[ -x "$(command -v alacritty)" ] || ( cd ~ && git clone https://github.com/alacritty/alacritty.git &&
    cd alacritty && curl --proto ''=https'' --tlsv1.2 -sSf https://sh.rustup.rs | sh &&
    rustup override set stable && rustup update stable &&
    apt install cmake g++ pkg-config libfontconfig1-dev libxcb-xfixes0-dev libxkbcommon-dev python3 &&
    cargo build --release &&
    sudo tic -xe alacritty,alacritty-direct extra/alacritty.info &&
    sudo cp target/release/alacritty /usr/local/bin &&
    sudo cp extra/logo/alacritty-term.svg /usr/share/pixmaps/Alacritty.svg &&
    sudo desktop-file-install extra/linux/Alacritty.desktop &&
    sudo update-desktop-database )'

- link:
  ~/.alacritty: alacritty/.alacritty.toml

# starship
- shell:
  - '[ -x "$(command -v starship)" ] || ( cd ~ && curl -sS https://starship.rs/install.sh | sh )'

- link:
  ~/.config/starship.toml: starship/.config/starship.toml

# tmux
- shell:
  - '[ -x "$(command -v tmux)" ] || ( sudo apt update && sudo apt install tmux )'

- link:
  ~/.tmux.conf: tmux/.tmux.conf

# vscode
- shell:
  - '[ -x "$(command -v vscode)" ] || ( cd ~ && sudo apt update && sudo apt install wget gpg &&
    wget -O vscode.deb https://code.visualstudio.com/sha/download?build=stable&os=linux-deb-x64 &&
    sudo apt install ./vscode.deb )'

- link:
  ~/.config/Code/User/keybindings.json: vscode/.config/Code/User/keybindings.json # vscode
  ~/.config/Code/User/settings.json: vscode/.config/Code/User/settings.json

- clean: ['~']
